function y= SpaceBeamElemStiffness(E,Ac,LL,Ic,G) 
%SpaceBeamElementStiffness This function returns the element stiffness
%matrix for a space beam element with modulus of elasticity
%E,cross-sectional area A,length L.
%The size of the element stiffness matrix is 12x12
X=(Ac*E)/LL;
Y1=(12*E*Ic)/LL^3;
Y2=(6*E*Ic)/LL^2;
Y3=(4*E*Ic)/LL;
Y4=(2*E*Ic)/LL;
S=(G*Ic)/LL;
Z1=(12*E*Ic)/LL^3;
Z2=(6*E*Ic)/LL^2;
Z3=(4*E*Ic)/LL;
Z4=(2*E*Ic)/LL;

y=zeros(12,12);

y(1,1)=X;
y(1,2)=0;
y(1,3)=0;
y(1,4)=0;
y(1,5)=0;
y(1,6)=0;
y(1,7)=-X;
y(1,8)=0;
y(1,9)=0;
y(1,10)=0;
y(1,11)=0;
y(1,12)=0;
y(2,1)=0;
y(2,2)=Y1;
y(2,3)=0;
y(2,4)=0;
y(2,5)=0;
y(2,6)=Y2;
y(2,7)=0;
y(2,8)=-Y1;
y(2,9)=0;
y(2,10)=0;
y(2,11)=0;
y(2,12)=Y2;
y(3,1)=0;
y(3,2)=0;
y(3,3)=Z1;
y(3,4)=0;
y(3,5)=-Z2;
y(3,6)=0;
y(3,7)=0;
y(3,8)=0;
y(3,9)=-Z1;
y(3,10)=0;
y(3,11)=-Z2;
y(3,12)=0;
y(4,1)=0;
y(4,2)=0;
y(4,3)=0;
y(4,4)=S;
y(4,5)=0;
y(4,6)=0;
y(4,7)=0;
y(4,8)=0;
y(4,9)=0;
y(4,10)=-S;
y(4,11)=0;
y(4,12)=0;
y(5,1)=0;
y(5,2)=0;
y(5,3)=-Z2;
y(5,4)=0;
y(5,5)=Z3;
y(5,6)=0;
y(5,7)=0;
y(5,8)=0;
y(5,9)=Z2;
y(5,10)=0;
y(5,11)=Z4;
y(5,12)=0;
y(6,1)=0;
y(6,2)=Y2;
y(6,3)=0;
y(6,4)=0;
y(6,5)=0;
y(6,6)=Y3;
y(6,7)=0;
y(6,8)=-Y2;
y(6,9)=0;
y(6,10)=0;
y(6,11)=0;
y(6,12)=Y4;
y(7,1)=-X;
y(7,2)=0;
y(7,3)=0;
y(7,4)=0;
y(7,5)=0;
y(7,6)=0;
y(7,7)=X;
y(7,8)=0;
y(7,9)=0;
y(7,10)=0;
y(7,11)=0;
y(7,12)=0;
y(8,1)=0;
y(8,2)=-Y1;
y(8,3)=0;
y(8,4)=0;
y(8,5)=0;
y(8,6)=-Y2;
y(8,7)=0;
y(8,8)=Y1;
y(8,9)=0;
y(8,10)=0;
y(8,11)=0;
y(8,12)=-Y2;
y(9,1)=0;
y(9,2)=0;
y(9,3)=-Z1;
y(9,4)=0;
y(9,5)=Z2;
y(9,6)=0;
y(9,7)=0;
y(9,8)=0;
y(9,9)=Z1;
y(9,10)=0;
y(9,11)=Z2;
y(9,12)=0;
y(10,1)=0;
y(10,2)=0;
y(10,3)=0;
y(10,4)=-S;
y(10,5)=0;
y(10,6)=0;
y(10,7)=0;
y(10,8)=0;
y(10,9)=0;
y(10,10)=S;
y(10,11)=0;
y(10,12)=0;
y(11,1)=0;
y(11,2)=0;
y(11,3)=-Z2;
y(11,4)=0;
y(11,5)=Z4;
y(11,6)=0;
y(11,7)=0;
y(11,8)=0;
y(11,9)=Z2;
y(11,10)=0;
y(11,11)=Z3;
y(11,12)=0;
y(12,1)=0;
y(12,2)=Y2;
y(12,3)=0;
y(12,4)=0;
y(12,5)=0;
y(12,6)=Y4;
y(12,7)=0;
y(12,8)=-Y2;
y(12,9)=0;
y(12,10)=0;
y(12,11)=0;
y(12,12)=Y3;
end

    


